using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;

namespace AspGen
{
    class MaterialIndex
    {

        public struct Material
        {
            public string matname;            // material name
            public double numpoints;          // if lookup table, this is number of points in table
            public double wlmin;              // minimum valid wavelength for lookup tables
            public double wlmax;              // maximum valid wavelength for lookup tables
            public string source_literature;  // reference if known
            public double[,] table;           // if lookup table is used, this is it
            public double[] sellarray;        // if Sellmeier is used, this is the coefficient array
            public Func<double, double[], double> sellfunc;  // pointer to the correct Sellmeier Function

            public Material(string mstr, double pts, double min, double max, string sl, double[,] intable, double[] insells, Func<double, double[], double> sfuncin)
            {
                matname = mstr;
                numpoints = pts;
                wlmin = min;
                wlmax = max;
                source_literature = sl;
                table = intable;
                sellarray = insells;
                sellfunc = sfuncin;
            }
        }

        #region Sellmeier Equations or Functions

        // CdTe
        static private Func<double, double[], double> sell0Func = (w, sell0) =>
                                                Math.Sqrt(
                                                sell0[0] +
                                                (sell0[1] * w * w) / (w * w - sell0[2]) +
                                                (sell0[3] * w * w) / (w * w - sell0[4]) );

        // ZnSe, BaF2, CaF2, Silicon
        static private Func<double, double[], double> sell1Func = (w, sell1) =>
                                        Math.Sqrt(1.0 +
                                        (sell1[0] * w * w) / (w * w - sell1[1] * sell1[1]) +
                                        (sell1[2] * w * w) / (w * w - sell1[3] * sell1[3]) +
                                        (sell1[4] * w * w) / (w * w - sell1[5] * sell1[5]));

        // legacy function used with silicon but is now obsolete
        static private Func<double, double[], double> sell2Func = (w, sell2) =>
                                        ( sell2[0] +
                                         (sell2[1] / (w * w - sell2[5])) +
                                         (sell2[2] / ((w * w - sell2[5]) * (w * w - sell2[5]))) +
                                         (sell2[3] * w * w) + 
                                         (sell2[4] * w * w * w * w) );

        // Diamond
        static private Func<double, double[], double> sell3Func = (w, sell1) =>
                                Math.Sqrt(1.0 +
                                (sell1[0] * w * w) / (w * w - sell1[1] * sell1[1]) +
                                (sell1[2] * w * w) / (w * w - sell1[3] * sell1[3]));

        #endregion

        #region Master Material List containing of the material information

        static List<Material> matlist =new List<Material> 
            {   
                new Material("ZnSe", 0, 0.5, 22, "II-VI Researched", null, new double[] { 4.38098350, 0.19656967, 0.54454510, 0.38544390, 2.88922500, 47.02109250 }, sell1Func),
                new Material("CdTe", 0, 1.0, 30.0, "Dodge and Malitson", null, new double[] { 3.7575, 3.4632, 0.1866, 6.2380, 9273.0 }, sell0Func),        
                new Material("BaF2", 0, 0.1345, 15.0, "Unknow", null, new double[] { 0.643356, 0.057789, 0.506762, 0.109680, 3.826100, 46.386400 }, sell1Func),
                new Material("CaF2", 0, 0.125, 12.0, "Unknow", null, new double[] { 0.567588800, 0.050263605, 0.471091400, 0.100390900, 3.848472300, 34.649040000 }, sell1Func),
                new Material("Silicon", 0, 1.36, 11.0, "Handbook of Optics, 3rd edition, Vol. 4. McGraw-Hill 2009", null, new double[] { 10.6684293, 0.301516485, 0.003043475, 1.13475115, 1.54133408, 1104.0}, sell1Func ),
                new Material("Diamond", 0, 0.225, 100, "http://refractiveindex.info/?group=CRYSTALS&material=C", null, new double[] { 4.3356, 0.1060, 0.3306, 0.1750 }, sell3Func),

                new Material(   "GaAs", 13, 2.5, 14, "Unknow",
                                        new double[,]	{{
                                        2.5000,  3.0000,  4.0000,  5.0000,  6.0000,
						                7.0000,  8.0000,  9.0000, 10.0000, 11.0000,
						                12.0000, 13.0000, 14.0000 }, 
                                        {3.3256,  3.3169,  3.3069,  3.3010,  3.2963,
						                3.2923,  3.2878,  3.2830,  3.2770,  3.2725,
						                3.2666,  3.2589,  3.2509 }},
                                        null, null ),

                new Material( "Ge", 17, 2.0581, 13.0200, "old Melles Groit catalogue",
                                        new double[,]	{{
                                        2.0581,  2.1526,  2.3126,  2.4374,  2.5770,
						                2.7144,  2.9980,  3.3033,  3.1488,  4.2580,
						                4.8660,  6.2380,  8.6600,  9.7200, 11.0400,
						                12.2000, 13.0200}, 
                                        {4.1018,  4.0919,  4.0785,  4.0709,  4.0608,
						                4.0554,  4.0452,  4.0372,  4.0339,  4.0217,
						                4.0167,  4.0095,  4.0043,  4.0033,  4.0025,
						                4.0020,  4.0018 }},
                                        null, null ),

                new Material("ZnS", 59, 0.4200, 18.2000, "Raytheon data, via M. J. Dodge",
                                        new double[,]   {{
                                        0.4200,  0.4600,  0.5000,  0.5400,  0.5800,
                                        0.6200,  0.6600,  0.7000,  0.7400,  0.7800,
                                        0.8200,  0.8600,  0.9000,  0.9400,  0.9800,
                                        1.0000,  1.4000,  1.8000,  2.2000,  2.6000,
                                        3.0000,  3.4000,  3.8000,  4.2000,  4.6000,
                                        5.0000,  5.4000,  5.8000,  6.2000,  6.6000,
                                        7.0000,  7.4000,  7.8000,  8.2000,  8.6000,
                                        9.0000,  9.4000,  9.8000, 10.2000, 10.6000,
                                        11.0000, 11.4000, 11.8000, 12.2000, 12.6000,
                                        13.0000, 13.4000, 13.8000, 14.2000, 14.6000,
                                        15.0000, 15.4000, 15.8000, 16.2000, 16.6000,
                                        17.0000, 17.4000, 17.8000, 18.2000}, {
                                        2.5160,  2.4580,  2.4190,  2.3910,  2.3710,
                                        2.3550,  2.3420,  2.3320,  2.3230,  2.3160,
                                        2.3100,  2.3050,  2.3010,  2.2970,  2.2940,
                                        2.2920,  2.2570,  2.2670,  2.2630,  2.2600,
                                        2.2570,  2.2550,  2.2530,  2.2510,  2.2480,
                                        2.2460,  2.2440,  2.2410,  2.2380,  2.2350,
                                        2.2320,  2.2280,  2.2250,  2.2210,  2.2170,
                                        2.2120,  2.2080,  2.2030,  2.1980,  2.1920,
                                        2.1860,  2.1800,  2.1730,  2.1670,  2.1590,
                                        2.1520,  2.1430,  2.1350,  2.1260,  2.1160,
                                        2.1060,  2.0950,  2.0840,  2.0720,  2.0590,
                                        2.0450,  2.0300,  2.0150,  1.9980 }}, 
                                        null, null ),

                new Material(  "Al2O3", 46, 0.2652, 5.5770, "(Sapphire) Optl. Matls. for IR Instr. or Optovac Catalogue ",
                                          new double[,]	{{
						                  0.2652,  0.2803,  0.2894,  0.2967,  0.3021,
						                  0.3130,  0.3341,  0.3466,  0.3611,  0.3650,
						                  0.3906,  0.4047,  0.4358,  0.5461,  0.5770,
						                  0.5791,  0.6438,  0.7065,  0.8521,  0.8944,
						                  1.0140,  1.1287,  1.3673,  1.3951,  1.5295,
						                  1.6932,  1.7091,  1.8131,  1.9701,  2.1526,
						                  2.2493,  2.3254,  2.4374,  3.2432,  3.2666,
						                  3.3030,  3.3293,  3.4188,  3.5078,  3.7000,
						                  4.2580,  4.9540,  5.1456,  5.3490,  5.4190,
						                  5.5770}, {
						                  1.8336,  1.8243,  1.8195,  1.8159,  1.8135,
						                  1.8091,  1.8018,  1.7981,  1.7945,  1.7936,
						                  1.7884,  1.7858,  1.7812,  1.7708,  1.7688,
						                  1.7687,  1.7655,  1.7630,  1.7588,  1.7579,
						                  1.7555,  1.7534,  1.7494,  1.7489,  1.7466,
						                  1.7437,  1.7434,  1.7414,  1.7383,  1.7344,
						                  1.7323,  1.7306,  1.7278,  1.7044,  1.7036,
						                  1.7023,  1.7015,  1.6982,  1.6950,  1.6875,
						                  1.6637,  1.6266,  1.6151,  1.6020,  1.5973,
						                  1.5864}},
                                          null, null ),

                new Material("PbF2", 43, 0.2909, 11.862, "Harshaw catalogue",
                                      new double[,]	{{
						              0.2909,  0.2967,  0.3022,  0.3351,  0.3650,
						              0.3663,  0.4047,  0.4358,  0.4678,  0.4800,
						              0.5086,  0.5461,  0.5770,  0.5790,  0.5876,
						              0.6438,  0.6678,  0.7065,  0.8521,  0.8944,
						              1.0140,  1.0830,  1.1290,  1.3600,  1.3950,
						              1.4700,  1.5300,  1.6930,  1.7140,  1.8130,
						              1.9700,  2.3250,  2.5770,  2.5740,  3.2440,
						              3.2670,  6.4120,  6.7080,  6.7870,  7.3880,
						              11.0350, 11.4750, 11.8620}, {
						              1.9722,  1.9471,  1.9299,  1.8704,  1.8408,
						              1.8398,  1.8156,  1.8016,  1.7907,  1.7873,
						              1.7802,  1.7729,  1.7680,  1.7677,  1.7665,
						              1.7599,  1.7577,  1.7545,  1.7463,  1.7447,
						              1.7411,  1.7395,  1.7387,  1.7352,  1.7348,
						              1.7340,  1.7334,  1.7321,  1.7319,  1.7312,
						              1.7301,  1.7279,  1.7262,  1.7258,  1.7221,
						              1.7219,  1.6929,  1.6892,  1.6882,  1.6802,
						              1.6155,  1.6058,  1.5969 }}, 
                                      null, null ),

                new Material( "ThF4", 7, 0.3, 25.0, "M. Bob, Various Guestimates collected from articles",
                                        new double[,] {{
                                        0.3000,  3.8000,  5.3000, 10.6000, 14.0000,
                                        16.0000, 25.0000}, {
                                        1.5800,  1.5000,  1.4900,  1.3500,  1.3200,
                                        1.3000,  1.2800}},
                                        null, null ),
        
                new Material ( "MgF2", 33, 1, 9, "Kodak Flyer",
                                        new double[,]	{{
						                1.0000,  1.2500,  1.5000,  1.7500,  2.0000,
						                2.2500,  2.5000,  2.7500,  3.0000,  3.2500,
						                3.5000,  3.7500,  4.0000,  4.2500,  4.5000,
						                4.7500,  5.0000,  5.2500,  5.5000,  5.7500,
						                6.0000,  6.2500,  6.5000,  6.7500,  7.0000,
						                7.2500,  7.5000,  7.7500,  8.0000,  8.2500,
						                8.5000,  8.7500,  9.0000}, {
						                1.3778,  1.3763,  1.3794,  1.3735,  1.3720,
						                1.3702,  1.3683,  1.3663,  1.3640,  1.3614,
						                1.3587,  1.3558,  1.3526,  1.3492,  1.3455,
						                1.3416,  1.3374,  1.3329,  1.3282,  1.3232,
						                1.3179,  1.3122,  1.3063,  1.3000,  1.2934,
						                1.2865,  1.2792,  1.2715,  1.2634,  1.2549,
						                1.2460,  1.2367,  1.2269}},
                                        null, null ),

                new Material( "MgO", 50, 0.3612, 9.0, "Optl. Matls. for IR Instr. and Kodak",
                                      new double[,] {{
						              0.3612,  0.3650,  1.0000,  1.0140,  1.1287,
						              1.2500,  1.3673,  1.5000,  1.5295,  1.6932,
						              1.7092,  1.7500,  1.8131,  1.9701,  2.0000,
						              2.2493,  2.2500,  2.3254,  2.5000,  2.7500,
						              3.0000,  3.2500,  3.3033,  3.5000,  3.5078,
						              3.7500,  4.0000,  4.2500,  4.2580,  4.5000,
						              4.7500,  5.0000,  5.1380,  5.2500,  5.3500,
						              5.5000,  5.7500,  6.0000,  6.2500,  6.5000,
						              6.7500,  7.0000,  7.2500,  7.5000,  7.7500,
						              8.0000,  8.2500,  8.5000,  8.7500,  9.0000}, {
						              1.7732,  1.7719,  1.7227,  1.7226,  1.7206,
						              1.7188,  1.7171,  1.7156,  1.7150,  1.7128,
						              1.7126,  1.7123,  1.7111,  1.7088,  1.7089,
						              1.7047,  1.7052,  1.7035,  1.7012,  1.6968,
						              1.6920,  1.6868,  1.6853,  1.6811,  1.6805,
						              1.6750,  1.6684,  1.6612,  1.6604,  1.6536,
						              1.6455,  1.6368,  1.6314,  1.6275,  1.6240,
						              1.6177,  1.6072,  1.5962,  1.5845,  1.5721,
						              1.5590,  1.5452,  1.5307,  1.5154,  1.4993,
						              1.4824,  1.4646,  1.4460,  1.4265,  1.4060 }},
                                      null, null ),

                new Material(   "TiO2", 18, 0.4358, 5.5, "Optovac Catalogue",
                                        new double[,] {{
						                0.4358,  0.4916,  0.4960,  0.5461,  0.5770,
						                0.5791,  0.6907,  0.7082,  1.0140,  1.5296,
						                2.0000,  2.5000,  3.0000,  3.5000,  4.0000,
						                4.5000,  5.0000,  5.5000}, {
						                2.8530,  2.7230,  2.7150,  2.6520,  2.6230,
						                2.6210,  2.5550,  2.5480,  2.4830,  2.4510,
						                2.3990,  2.3870,  2.3800,  2.3670,  2.3500,
						                2.3220,  2.2900,  2.2000 }},
                                        null, null ),

                new Material(  "As2S3", 26, 0.577, 11.862, "Optl. Matls. for IR Instr.", 
                                        new double[,] {{
						                0.5770,  0.5790,  0.5876,  0.6439,  0.6678,
						                0.6908,  0.7065,  0.8521,  0.8944,  1.0140,
						                1.1287,  1.3951,  1.5295,  1.7006,  1.8131,
						                1.9701,  3.4188,  4.2580,  5.1380,  6.2380,
						                6.6920,  8.6620,  9.7240, 11.0350, 11.4750,
						                11.8620}, {
						                2.6632,  2.6605,  2.6501,  2.5976,  2.5808,
						                2.5670,  2.5586,  2.5061,  2.4963,  2.4757,
						                2.4623,  2.4438,  2.4380,  2.4326,  2.4300,
						                2.4268,  2.4137,  2.4101,  2.4067,  2.4022,
						                2.1003,  2.3903,  2.3834,  2.3736,  2.3694,
						                2.3658 }},
                                        null, null ),

                new Material("Fused Silica", 65, 0.34, 3.5, "Unknow", 
                                            new double[,] {{
						                    0.3400,  0.3500,  0.3600,  0.3700,  0.3800,
						                    0.3900,  0.4000,  0.4100,  0.4200,  0.4300,
						                    0.4400,  0.4500,  0.4600,  0.4700,  0.4800,
						                    0.4900,  0.5000,  0.5100,  0.5200,  0.5300,
						                    0.5400,  0.5500,  0.5600,  0.5700,  0.5800,
						                    0.5900,  0.6000,  0.6100,  0.6200,  0.6300,
						                    0.6400,  0.6500,  0.6600,  0.6700,  0.6800,
						                    0.6900,  0.7000,  0.8000,  0.9000,  1.0000,
						                    1.1000,  1.2000,  1.3000,  1.4000,  1.5000,
						                    1.6000,  1.7000,  1.8000,  1.9000,  2.0000,
						                    2.1000,  2.2000,  2.3000,  2.4000,  2.5000,
						                    2.6000,  2.7000,  2.8000,  2.9000,  3.0000,
						                    3.1000,  3.2000,  3.3000,  3.4000,  3.5000}, {
						                    1.4788,  1.4770,  1.4754,  1.4739,  1.4726,
						                    1.4713,  1.4702,  1.4691,  1.4682,  1.4673,
						                    1.4664,  1.4656,  1.4649,  1.4642,  1.4636,
						                    1.4630,  1.4624,  1.4619,  1.4613,  1.4609,
						                    1.4604,  1.4600,  1.4596,  1.4592,  1.4588,
						                    1.4584,  1.4581,  1.4578,  1.4575,  1.4572,
						                    1.4569,  1.4566,  1.4563,  1.4561,  1.4558,
						                    1.4556,  1.4553,  1.4534,  1.4518,  1.4505,
						                    1.4493,  1.4481,  1.4470,  1.4458,  1.4447,
						                    1.4435,  1.4422,  1.4409,  1.4396,  1.4382,
						                    1.4367,  1.4351,  1.4335,  1.4317,  1.4299,
						                    1.4280,  1.4260,  1.4239,  1.4217,  1.4194,
						                    1.4169,  1.4144,  1.4117,  1.4089,  1.4060 }},
                                            null, null ),

                new Material(   "NaCl", 71, 0.5, 22.3, "Optovac Catalogue and Optl.Matl.for IR",
                                        new double[,] {{
                                        0.5000,  0.5890,  0.6400,  0.6874,  0.7604,
                                        0.7858,  0.8835,  0.9033,  0.9724,  1.0000,
                                        1.0084,  1.0540,  1.0810,  1.1058,  1.1420,
                                        1.1486,  1.2016,  1.2604,  1.3126,  1.4874,
                                        1.5552,  1.6368,  1.6848,  1.7670,  2.0000,
                                        2.0736,  2.1824,  2.2464,  2.3560,  2.6505,
                                        2.9466,  3.0000,  3.2736,  3.5359,  3.6288,
                                        3.8192,  4.0000,  4.1230,  4.7120,  5.0000,
                                        5.0092,  5.3009,  5.8932,  6.0000,  6.4825,
                                        6.8000,  7.0000,  7.0718,  7.2200,  7.5900,
                                        7.6611,  7.9558,  8.0000,  8.0400,  8.8398,
                                        9.0000,  9.5000, 10.0000, 10.0184, 11.0000,
                                        11.7864, 12.5000, 12.9650, 13.0000, 14.1436,
                                        14.7330, 15.3223, 15.9116, 17.9300, 20.5700,
                                        22.3000}, {
                                        1.5440,  1.5443,  1.5414,  1.5393,  1.5368,
                                        1.5361,  1.5339,  1.5336,  1.5325,  1.5320,
                                        1.5321,  1.5315,  1.5312,  1.5310,  1.5306,
                                        1.5303,  1.5301,  1.5297,  1.5294,  1.5284,
                                        1.5281,  1.5278,  1.5276,  1.5274,  1.5270,
                                        1.5265,  1.5262,  1.5261,  1.5258,  1.5251,
                                        1.5247,  1.5230,  1.5237,  1.5231,  1.5229,
                                        1.5224,  1.5210,  1.5216,  1.5198,  1.5190,
                                        1.5188,  1.5179,  1.5159,  1.5150,  1.5135,
                                        1.5120,  1.5100,  1.5109,  1.5102,  1.5085,
                                        1.5082,  1.5066,  1.5060,  1.5064,  1.5019,
                                        1.5010,  1.4998,  1.4950,  1.4946,  1.4880,
                                        1.4817,  1.4757,  1.4716,  1.4666,  1.4604,
                                        1.4543,  1.4474,  1.4409,  1.4149,  1.3735,
                                        1.3403 }},
                                        null, null ),

                new Material("KBr", 32, 0.4047, 25.14, "Unknow",
                                    new double[,] {{
                                    0.4047,  0.4358,  0.4861,  0.5086,  0.5461,
                                    0.5876,  0.6438,  0.7065,  1.0140,  1.1287,
                                    1.3673,  1.7012,  2.4400,  2.7300,  3.4190,
                                    4.2580,  6.2380,  6.6920,  8.6620,  9.7240,
                                    11.0350, 11.8620, 14.2900, 14.9800, 17.4000,
                                    18.1600, 19.0100, 19.9100, 21.1800, 21.8300,
                                    23.8600, 25.1400}, {
                                    1.5898,  1.5815,  1.5718,  1.5685,  1.5639,
                                    1.5600,  1.5559,  1.5524,  1.5441,  1.5426,
                                    1.5406,  1.5390,  1.5373,  1.5369,  1.5361,
                                    1.5352,  1.5329,  1.5322,  1.5290,  1.5269,
                                    1.5240,  1.5220,  1.5150,  1.5128,  1.5039,
                                    1.5008,  1.4970,  1.4929,  1.4865,  1.4831,
                                    1.4714,  1.4632 }},
                                    null, null ),

                new Material("KCl", 11, 0.21, 18.8, "Unknow",
                                    new double[,] {{
                                    0.2100,  0.5000,  1.2000,  2.3573,  4.7000,
                                    5.3039, 10.1840, 14.1000, 15.9120, 18.1000,
                                    18.8000}, {
                                    1.7200,  1.4900,  1.4800,  1.4747,  1.4700,
                                    1.4700,  1.4567,  1.4400,  1.4262,  1.4100,
                                    1.4010 }},
                                    null, null ),

                new Material("CsI", 51, 0.5, 50.0, "Unknow",
                                    new double[,] {{
                                    0.5000,  1.0000,  2.0000,  3.0000,  4.0000,
                                    5.0000,  6.0000,  7.0000,  8.0000,  9.0000,
                                    10.0000, 11.0000, 12.0000, 13.0000, 14.0000,
                                    15.0000, 16.0000, 17.0000, 18.0000, 19.0000,
                                    20.0000, 21.0000, 22.0000, 23.0000, 24.0000,
                                    25.0000, 26.0000, 27.0000, 28.0000, 29.0000,
                                    30.0000, 31.0000, 32.0000, 33.0000, 34.0000,
                                    35.0000, 36.0000, 37.0000, 38.0000, 39.0000,
                                    40.0000, 41.0000, 42.0000, 43.0000, 44.0000,
                                    45.0000, 46.0000, 47.0000, 48.0000, 49.0000,
                                    50.0000}, {
                                    1.8063,  1.7572,  1.7462,  1.7440,  1.7430,
                                    1.7424,  1.7418,  1.7412,  1.7406,  1.7399,
                                    1.7392,  1.7383,  1.7375,  1.7365,  1.7355,
                                    1.7344,  1.7332,  1.7319,  1.7306,  1.7291,
                                    1.7276,  1.7260,  1.7243,  1.7226,  1.7207,
                                    1.7188,  1.7168,  1.7146,  1.7124,  1.7101,
                                    1.7077,  1.7052,  1.7027,  1.7000,  1.6972,
                                    1.6943,  1.6913,  1.6881,  1.6849,  1.6816,
                                    1.6781,  1.6746,  1.6709,  1.6671,  1.6631,
                                    1.6590,  1.6548,  1.6505,  1.6460,  1.6414,
                                    1.6366 }},
                                    null, null ),

                new Material( "CsBr", 40, 0.5, 39.0, "Unknow",
                                        new double[,] {{
						                0.5000,  1.0000,  2.0000,  3.0000,  4.0000,
						                5.0000,  6.0000,  7.0000,  8.0000,  9.0000,
						                10.0000, 11.0000, 12.0000, 13.0000, 14.0000,
						                15.0000, 16.0000, 17.0000, 18.0000, 19.0000,
						                20.0000, 21.0000, 22.0000, 23.0000, 24.0000,
						                25.0000, 26.0000, 27.0000, 28.0000, 29.0000,
						                30.0000, 31.0000, 32.0000, 33.0000, 34.0000,
						                35.0000, 36.0000, 37.0000, 38.0000, 39.0000}, {
						                1.7090,  1.6779,  1.6706,  1.6690,  1.6681,
						                1.6674,  1.6666,  1.6657,  1.6648,  1.6637,
						                1.6625,  1.6612,  1.6598,  1.6582,  1.6565,
						                1.6547,  1.6527,  1.6506,  1.6484,  1.6460,
						                1.6435,  1.6408,  1.6380,  1.6350,  1.6319,
						                1.6286,  1.6251,  1.6215,  1.6176,  1.1636,
						                1.6095,  1.6051,  1.6005,  1.5958,  1.5908,
						                1.5856,  1.5802,  1.5745,  1.5686,  1.5624 }},
                                        null, null),

                new Material("Se", 3, 2.5, 15.0, "Unknow",
                                          new double[,] {{
						                  2.5000,  5.0000, 15.0000}, {
						                  2.4500,  2.4200,  2.3800 }},
                                          null, null),

                new Material("AMTIR-1", 17, 1.0, 14.0, "Amorphous Materials Catalogue",
                                        new double[,] {{
                                        1.0000,  1.0640,  1.5000,  2.0000,  2.4000,
                                        3.0000,  4.0000,  5.0000,  6.0000,  7.0000,
                                        8.0000,  9.0000, 10.0000, 11.0000, 12.0000,
                                        13.0000, 14.0000}, {
                                        2.6055,  2.5933,  2.5469,  2.5310,  2.5250,
                                        2.5187,  2.5141,  2.5109,  2.5080,  2.5057,
                                        2.5034,  2.5005,  2.4976,  2.4936,  2.4904,
                                        2.4850,  2.4825 }},
                                        null, null),

                new Material(   "NaF2", 27, 0.186, 17.30, "Unknow", 
                                        new double[,] {{
				                        0.1860,  0.1990,  0.2030,  0.3020,  0.4050,
				                        0.4860,  0.5460,  0.5890,  0.7070,  0.8110,
				                        0.9120,  1.0140,  2.0000,  3.1000,  4.1000,
				                        5.1000,  6.1000,  7.1000,  8.1000,  9.1000,
				                        10.3000, 11.3000, 12.5000, 13.8000, 15.1000,
				                        16.7000, 17.3000}, {
				                        1.3930,  1.3805,  1.3772,  1.3423,  1.3319,
				                        1.3282,  1.3264,  1.3255,  1.3237,  1.3227,
				                        1.3220,  1.3215,  1.3170,  1.3130,  1.3080,
				                        1.3010,  1.2920,  1.2810,  1.2690,  1.2620,
				                        1.2330,  1.2090,  1.1800,  1.1420,  1.0930,
				                        1.0340,  1.0000 }},
                                        null, null) 
            };

        #endregion

        #region Public & Private Methods

        // Return the material names from the master material list
        static public string[] GetMatNameList()
        {
            List<string> listmatnames = new List<string>();
            foreach (Material m in matlist)
                listmatnames.Add(m.matname);
            listmatnames.Sort();
            listmatnames.Insert(0, "Custom");
            return listmatnames.ToArray();
        }

        // Return the entire structure to caller
        static public Material GetMaterialStructure(string MatNo)
        {
            for (int i = 0; i < matlist.Count; i++)
                if (matlist[i].matname == MatNo)
                    return matlist[i];
            return new Material("Unknown", 0, 0, 0, "na", null, null, null);
        }
        
        // Use this one to get a single index value given a single wavelength
        static public double GetIndex(string MatNo, double Wl)
        {
            for (int i = 0; i < matlist.Count; i++)
                if (matlist[i].matname == MatNo)
                    if (matlist[i].numpoints == 0)
                        return matlist[i].sellfunc(Wl, matlist[i].sellarray);  // get index from Sellmeier Function
                    else
                        return FindIndexInTable(Wl, matlist[i]);               // get index from lookup table
            return -1.0;  // return this as error code
        }

        // Use this one if you have an array of wavelengths of unequal increments.
        static public double[] GetIndexArray(string MatNo, double[] wls)
        {
            double[] indices = new double[wls.Count()];

            for (int i = 0; i < matlist.Count; i++)
                if (matlist[i].matname == MatNo)
                {
                    for (int j =0; j < wls.Count(); j++)
                        if (matlist[i].numpoints == 0)
                            indices[j] = matlist[i].sellfunc(wls[j], matlist[i].sellarray);  // get index from Sellmeier Function
                        else
                            indices[j] = FindIndexInTable(wls[j], matlist[i]);               // get index from lookup table
                    break;
                }

            return indices;
        }

        // Private function that returns an index from a lookup table
        static public double FindIndexInTable(double w, Material m)
        {
            double Index;
            if ((w < m.wlmin) || (w > m.wlmax))
                return -2.0;
            for (int i = 0; i < m.numpoints; i++)
            {
                if ((w >= m.table[0, i]) && (w <= m.table[0, i + 1]))
                {
                    Index = m.table[1, i] + (m.table[1, i + 1] - m.table[1, i]) /
                                    (m.table[0, i + 1] - m.table[0, i]) *
                                    (w - m.table[0, i]);
                    return Index;
                }
            }
            return -2.0;
        }

        #endregion
    }
}
